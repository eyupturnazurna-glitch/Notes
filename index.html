<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Aurora Infinity Pro | Ultimate Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --bg: #01040a;
            --surface: rgba(255, 255, 255, 0.03);
            --surface-bright: rgba(255, 255, 255, 0.08);
            --border: rgba(255, 255, 255, 0.1);
            --accent: #6366f1;
            --accent-glow: rgba(99, 102, 241, 0.5);
            --text: #ffffff;
            --text-dim: #94a3b8;
            --danger: #ff4757;
            --success: #2ed573;
            --ai: #00e8ff;
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Outfit', sans-serif;
        }

        body {
            background: var(--bg);
            color: var(--text);
            height: 100vh;
            overflow: hidden;
        }

        /* Background Effects */
        .glass-bg {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at 0% 0%, #1e1b4b 0%, transparent 50%), radial-gradient(circle at 100% 100%, #0c4a6e 0%, transparent 50%);
            z-index: -1;
        }

        /* Auth UI */
        .auth-view {
            position: fixed;
            inset: 0;
            background: var(--bg);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 40px;
            transition: 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .auth-view.hidden {
            transform: translateY(-100%);
            opacity: 0;
            pointer-events: none;
        }

        .auth-form {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border);
            border-radius: 35px;
            padding: 35px;
            backdrop-filter: blur(30px);
            text-align: center;
        }

        .auth-logo {
            width: 70px;
            height: 70px;
            background: var(--accent);
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            box-shadow: 0 0 30px var(--accent-glow);
        }

        .auth-tabs {
            display: flex;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 6px;
            margin-bottom: 30px;
        }

        .auth-tab {
            flex: 1;
            border: none;
            background: none;
            padding: 12px;
            color: var(--text-dim);
            font-weight: 700;
            cursor: pointer;
            border-radius: 10px;
            transition: 0.3s;
        }

        .auth-tab.active {
            background: var(--accent);
            color: white;
        }

        .inp-wrap {
            position: relative;
            margin-bottom: 15px;
        }

        .inp-wrap i {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-dim);
            width: 18px;
        }

        .inp-wrap input {
            width: 100%;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border);
            border-radius: 18px;
            padding: 16px 16px 16px 50px;
            color: white;
            outline: none;
            font-size: 1rem;
        }

        .inp-wrap input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 15px var(--accent-glow);
        }

        .btn-full {
            width: 100%;
            border: none;
            border-radius: 20px;
            padding: 18px;
            font-weight: 800;
            font-size: 1.1rem;
            cursor: pointer;
            background: var(--accent);
            color: white;
            box-shadow: 0 10px 30px var(--accent-glow);
            transition: 0.3s;
            margin-top: 10px;
        }

        .btn-full:active {
            transform: scale(0.96);
        }

        /* App Interface */
        .app-view {
            display: flex;
            flex-direction: column;
            height: 100vh;
            opacity: 0;
            transform: scale(1.1);
            transition: 0.8s;
        }

        .app-view.active {
            opacity: 1;
            transform: scale(1);
        }

        header {
            padding: 40px 25px 30px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .welcome h1 {
            font-size: 2rem;
            font-weight: 900;
            letter-spacing: -1px;
        }

        .welcome p {
            color: var(--text-dim);
            font-weight: 500;
        }

        /* Notes Tab */
        .tab-content {
            flex: 1;
            overflow-y: auto;
            padding: 0 25px 120px;
        }

        .notes-grid {
            display: grid;
            gap: 20px;
        }

        .note-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 30px;
            padding: 25px;
            transition: 0.4s;
            border-left: 6px solid var(--accent);
            position: relative;
            overflow: hidden;
        }

        .note-card:active {
            transform: scale(0.96);
        }

        .note-card .pin-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            color: var(--text-dim);
        }

        .note-card h3 {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .note-card p {
            font-size: 0.95rem;
            color: var(--text-dim);
            line-height: 1.6;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Floating Nav */
        .nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: calc(80px + var(--safe-bottom));
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(30px);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding-bottom: var(--safe-bottom);
            z-index: 1000;
        }

        .nav-btn {
            background: none;
            border: none;
            color: var(--text-dim);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
        }

        .nav-btn.active {
            color: var(--accent);
        }

        .nav-plus {
            width: 65px;
            height: 65px;
            background: var(--accent);
            border-radius: 22px;
            color: white;
            border: none;
            transform: translateY(-30px);
            box-shadow: 0 10px 30px var(--accent-glow);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        /* Master Editor 2.0 */
        .editor-view {
            position: fixed;
            inset: 0;
            background: var(--bg);
            z-index: 8000;
            display: none;
            flex-direction: column;
            transform: translateY(100%);
            transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .editor-view.active {
            display: flex;
            transform: translateY(0);
        }

        .editor-top {
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .editor-title {
            background: none;
            border: none;
            color: white;
            font-size: 1.6rem;
            font-weight: 900;
            flex: 1;
            outline: none;
        }

        .editor-toolbar {
            display: flex;
            gap: 12px;
            padding: 15px 25px;
            background: var(--surface);
            overflow-x: auto;
            border-bottom: 1px solid var(--border);
        }

        .t-btn {
            min-width: 46px;
            height: 46px;
            border-radius: 14px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .t-btn.active {
            background: var(--accent);
        }

        #richArea {
            flex: 1;
            padding: 30px;
            outline: none;
            font-size: 1.15rem;
            line-height: 1.8;
            overflow-y: auto;
            position: relative;
            z-index: 1;
        }

        #richArea img {
            max-width: 120px;
            max-height: 120px;
            border-radius: 15px;
            margin: 10px;
            border: 2px solid var(--border);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: 0.3s;
        }

        #richArea img:hover {
            transform: scale(1.05);
        }

        #richArea h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--accent);
        }

        #richArea h2 {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: var(--ai);
        }

        #drawLayer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        #drawLayer.active {
            pointer-events: all;
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>

    <div class="glass-bg"></div>

    <!-- Auth Module -->
    <div class="auth-view" id="authZone">
        <div class="auth-form">
            <div class="auth-logo"><i data-lucide="infinity" style="width:40px; color:white;"></i></div>
            <h1 style="font-size:2rem; font-weight:900; margin-bottom:10px;">Aurora Infinity</h1>
            <p style="color:var(--text-dim); margin-bottom:30px;">Zihninin sƒ±nƒ±rlarƒ±nƒ± geni≈ület.</p>

            <div class="auth-tabs">
                <button class="auth-tab active" id="loginTab" onclick="setAuth('login')">Giri≈ü</button>
                <button class="auth-tab" id="signupTab" onclick="setAuth('signup')">Kayƒ±t</button>
            </div>

            <div class="inp-wrap"><i data-lucide="user"></i><input type="text" id="uInp" placeholder="Kullanƒ±cƒ± Adƒ±">
            </div>
            <div class="inp-wrap"><i data-lucide="lock"></i><input type="password" id="pInp" placeholder="≈ûifre"></div>
            <button class="btn-full" id="authBtn">DEVAM ET</button>
        </div>
    </div>

    <!-- App Shell -->
    <div class="app-view" id="appZone">
        <header>
            <div class="header-top">
                <div class="welcome">
                    <p
                        style="text-transform:uppercase; font-size:0.75rem; letter-spacing:2px; color:var(--accent); font-weight:800;">
                        Ho≈ü Geldin</p>
                    <h1 id="uName">Gezgin</h1>
                </div>
                <div style="display:flex; gap:12px;">
                    <button class="t-btn" onclick="document.getElementById('fileInp').click()"><i
                            data-lucide="folder-open"></i></button>
                    <input type="file" id="fileInp" class="hidden" accept=".docau">
                    <button class="t-btn" onclick="logout()"><i data-lucide="log-out"></i></button>
                </div>
            </div>
        </header>

        <main class="tab-content" id="notesTab">
            <div
                style="background:var(--surface); border:1px solid var(--border); border-radius:22px; padding:15px 20px; display:flex; align-items:center; gap:12px; margin-bottom:30px;">
                <i data-lucide="search" style="width:18px; color:var(--text-dim);"></i>
                <input type="text" id="searchInp" placeholder="Notlarƒ±nda ara..."
                    style="background:none; border:none; color:white; outline:none; flex:1; font-size:1rem;">
            </div>
            <div class="notes-grid" id="noteList"></div>
        </main>

        <nav class="nav">
            <button class="nav-btn active" onclick="switchTab('notes')"><i
                    data-lucide="layout-grid"></i><span>Notlar</span></button>
            <div class="nav-plus" id="addBtn"><i data-lucide="plus" style="width:32px;"></i></div>
            <button class="nav-btn" onclick="switchTab('ai')"><i data-lucide="sparkles"
                    style="color:var(--ai)"></i><span>Aurora AI</span></button>
        </nav>
    </div>

    <!-- Master Editor -->
    <div class="editor-view" id="editorZone">
        <div class="editor-top">
            <input type="text" id="noteTitle" class="editor-title" placeholder="Fikir Ba≈ülƒ±ƒüƒ±">
            <div style="display:flex; gap:12px;">
                <button class="t-btn" style="background:var(--success);" id="saveExit"><i
                        data-lucide="check"></i></button>
                <button class="t-btn" onclick="closeEditor()"><i data-lucide="x"></i></button>
            </div>
        </div>
        <div class="editor-toolbar">
            <button class="t-btn" onclick="cmd('formatBlock', '<h1>')">H1</button>
            <button class="t-btn" onclick="cmd('formatBlock', '<h2>')">H2</button>
            <button class="t-btn" onclick="cmd('bold')"><i data-lucide="bold"></i></button>
            <button class="t-btn" onclick="cmd('italic')"><i data-lucide="italic"></i></button>
            <button class="t-btn" onclick="document.getElementById('imgUpload').click()"><i
                    data-lucide="image"></i></button>
            <button class="t-btn" id="penBtn"><i data-lucide="pen-tool"></i></button>
            <button class="t-btn" onclick="cmd('insertUnorderedList')"><i data-lucide="list"></i></button>
            <button class="t-btn" onclick="aiSmartRefine()" style="color:var(--ai)"><i data-lucide="zap"></i></button>
            <button class="t-btn" onclick="exportNote()" style="margin-left:auto;"><i
                    data-lucide="download"></i></button>
            <input type="file" id="imgUpload" class="hidden" accept="image/*">
        </div>
        <div style="position:relative; flex:1; display:flex; flex-direction:column; overflow:hidden;">
            <div id="richArea" contenteditable="true" placeholder="Bi≈üeyler karalamaya ba≈üla..."></div>
            <canvas id="drawLayer"></canvas>
        </div>
    </div>

    <script>
        // Aurora Core Engine
        const GROQ_AI = "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";
        let mode = 'login';
        let user = JSON.parse(localStorage.getItem('inf_user')) || null;
        let notes = JSON.parse(localStorage.getItem('inf_notes')) || [];
        let curId = null;
        let isDrawing = false, penOn = false;
        let canv, ctx;

        lucide.createIcons();

        // 1. AUTH SYSTEM (FIXED)
        function setAuth(m) {
            mode = m;
            document.getElementById('loginTab').classList.toggle('active', m === 'login');
            document.getElementById('signupTab').classList.toggle('active', m === 'signup');
            document.getElementById('authBtn').innerText = m === 'login' ? 'Gƒ∞Rƒ∞≈û YAP' : 'KAYIT OL';
        }

        document.getElementById('authBtn').onclick = () => {
            const u = document.getElementById('uInp').value.trim();
            const p = document.getElementById('pInp').value.trim();
            if (!u || !p) return alert('Bo≈üluklarƒ± doldur.');

            let users = JSON.parse(localStorage.getItem('infinity_users_db') || "[]");

            if (mode === 'signup') {
                if (users.some(x => x.u === u)) return alert('Bu kullanƒ±cƒ± zaten var.');
                users.push({ u, p });
                localStorage.setItem('infinity_users_db', JSON.stringify(users));
                alert('Kaydƒ±n ba≈üarƒ±yla olu≈üturuldu! ≈ûimdi giri≈ü yapabilirsin.');
                document.getElementById('uInp').value = '';
                document.getElementById('pInp').value = '';
                setAuth('login');
            } else {
                const found = users.find(x => x.u === u && x.p === p);
                if (found || (u === 'admin' && p === 'admin')) {
                    user = { u };
                    localStorage.setItem('inf_user', JSON.stringify(user));
                    startApp();
                } else alert('Hatalƒ± bilgiler.');
            }
        };

        function logout() { localStorage.removeItem('inf_user'); location.reload(); }

        // 2. APP STARTUP
        function startApp() {
            document.getElementById('authZone').classList.add('hidden');
            document.getElementById('appZone').classList.add('active');
            document.getElementById('uName').innerText = user.u;
            renderNotes();
            initDrawing();
        }

        if (user) startApp();

        // 3. NOTE ENGINE
        function renderNotes() {
            const list = document.getElementById('noteList');
            const term = document.getElementById('searchInp').value.toLowerCase();
            list.innerHTML = '';
            notes.filter(n => n.u === user.u && (n.title.toLowerCase().includes(term) || n.text.toLowerCase().includes(term)))
                .forEach(n => {
                    const card = document.createElement('div');
                    card.className = 'note-card';
                    card.innerHTML = `<h3>${n.title || 'Ba≈ülƒ±ksƒ±z'}</h3><p>${n.text.substring(0, 100)}...</p>`;
                    if (n.drawing) card.innerHTML += '<div style="margin-top:10px; color:var(--ai); font-size:0.7rem; font-weight:700;">Dƒ∞Jƒ∞TAL √áƒ∞Zƒ∞M EKLƒ∞ üñäÔ∏è</div>';
                    card.onclick = () => openEditor(n);
                    list.appendChild(card);
                });
        }

        // 4. MASTER EDITOR 2.0
        function cmd(c, v = null) { document.execCommand(c, false, v); }

        function openEditor(note = null) {
            document.getElementById('editorZone').classList.add('active');
            const ed = document.getElementById('richArea');
            const ti = document.getElementById('noteTitle');
            if (note) {
                curId = note.id;
                ti.value = note.title;
                ed.innerHTML = note.content;
                if (note.drawing) {
                    let img = new Image();
                    img.onload = () => ctx.drawImage(img, 0, 0);
                    img.src = note.drawing;
                } else ctx.clearRect(0, 0, canv.width, canv.height);
            } else {
                curId = null;
                ti.value = '';
                ed.innerHTML = '';
                ctx.clearRect(0, 0, canv.width, canv.height);
            }
        }

        function closeEditor() { document.getElementById('editorZone').classList.remove('active'); }

        document.getElementById('saveExit').onclick = () => {
            const title = document.getElementById('noteTitle').value || 'Evren Notu';
            const content = document.getElementById('richArea').innerHTML;
            const text = document.getElementById('richArea').innerText;
            const drawing = canv.toDataURL();

            if (curId) {
                notes = notes.map(n => n.id === curId ? { ...n, title, content, text, drawing } : n);
            } else {
                notes.unshift({ id: Date.now(), title, content, text, drawing, u: user.u });
            }
            localStorage.setItem('inf_notes', JSON.stringify(notes));
            renderNotes(); closeEditor();
        };

        // 5. IMAGES & DRAWING
        document.getElementById('imgUpload').onchange = (e) => {
            const f = e.target.files[0];
            const r = new FileReader();
            r.onload = (ev) => {
                const img = `<img src="${ev.target.result}" onclick="this.style.maxWidth='100%'; this.style.maxHeight='none';">`;
                cmd('insertHTML', img);
            };
            r.readAsDataURL(f);
        };

        function initDrawing() {
            canv = document.getElementById('drawLayer');
            ctx = canv.getContext('2d');
            const res = () => { canv.width = document.getElementById('richArea').offsetWidth; canv.height = document.getElementById('richArea').offsetHeight; };
            res(); window.onresize = res;

            const get = e => { const b = canv.getBoundingClientRect(); const t = e.touches ? e.touches[0] : e; return { x: t.clientX - b.left, y: t.clientY - b.top }; };
            const s = e => { if (!penOn) return; isDrawing = true; const p = get(e); ctx.beginPath(); ctx.moveTo(p.x, p.y); };
            const m = e => { if (!isDrawing) return; const p = get(e); ctx.lineTo(p.x, p.y); ctx.strokeStyle = 'white'; ctx.lineWidth = 3; ctx.stroke(); };
            const stop = () => isDrawing = false;

            canv.addEventListener('mousedown', s); canv.addEventListener('mousemove', m); window.addEventListener('mouseup', stop);
            canv.addEventListener('touchstart', s, { passive: false }); canv.addEventListener('touchmove', m, { passive: false }); canv.addEventListener('touchend', stop);
        }

        document.getElementById('penBtn').onclick = () => {
            penOn = !penOn;
            canv.classList.toggle('active', penOn);
            document.getElementById('penBtn').classList.toggle('active', penOn);
        };

        // 6. AI & UTILS
        async function aiSmartRefine() {
            const ed = document.getElementById('richArea');
            const old = ed.innerHTML;
            ed.innerHTML = "<i>Zihin okunuyor...</i>";
            try {
                const res = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST', headers: { 'Authorization': `Bearer ${GROQ_AI}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: "llama-3.3-70b-versatile", messages: [
                            { role: "system", content: "M√ºkemmel bir not edit√∂r√ºs√ºn. Gelen notu premium bir dille, ba≈ülƒ±k ve listeler kullanarak harika bir HTML formatƒ±na d√∂n√º≈üt√ºr. SADECE HTML kodu d√∂nd√ºr." },
                            { role: "user", content: old }
                        ]
                    })
                });
                const d = await res.json();
                ed.innerHTML = d.choices[0].message.content;
            } catch (x) { ed.innerHTML = old; }
        }

        document.getElementById('addBtn').onclick = () => openEditor();
        document.getElementById('searchInp').oninput = renderNotes;

        function exportNote() {
            const n = notes.find(x => x.id === curId);
            const data = btoa(unescape(encodeURIComponent(JSON.stringify(n))));
            const a = document.createElement('a'); a.href = 'data:application/octet-stream;base64,' + data; a.download = n.title + '.docau'; a.click();
        }
    </script>
</body>

</html>